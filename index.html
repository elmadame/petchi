<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PETCHI 1.1</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f4f4f4;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        #game-container {
            display: inline-block;
            padding: 10px;
            border: 2px solid black;
            background-color: #fff;
            margin-top: 50px;
            position: relative;
        }

        /* Pixel Frame */
        #frame {
            width: 200px;
            height: 200px;
            border: 5px solid black;
            padding: 5px;
            margin: 0 auto;
            background-color: #e0e0e0;
            position: relative;
        }

        .pixel-art {
            display: grid;
            grid-template-columns: repeat(7, 10px);
            grid-template-rows: repeat(7, 10px);
            position: absolute;
        }

        .pixel {
            width: 10px;
            height: 10px;
        }

        .black { background-color: black; }
        .gray { background-color: gray; }
        .white { background-color: white; }
        .pink { background-color: pink; }
        .yellow { background-color: yellow; }
        .brown { background-color: brown; }
        .transparent { background-color: transparent; }

        /* Pet Size Adjusted */
        #pet-container {
            position: absolute;
            width: 75px;
            height: 75px;
            animation: idle-animation 1s steps(2) infinite;
        }

        @keyframes idle-animation {
            0% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
            100% { transform: translateY(0); }
        }

        #zzzz {
            display: none;
            font-size: 20px;
            position: absolute;
            top: 5px;
            left: 20px;
            color: #333;
            animation: zzzz-animation 1s infinite;
        }

        @keyframes zzzz-animation {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        /* Poop Pixel Art and Positioning */
        #poop {
            display: none;
            width: 45px;
            height: 45px;
            position: absolute;
            bottom: 10px;
            right: 10px;
            animation: poop-animation 1s infinite;
        }

        @keyframes poop-animation {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        /* Pet Name Styling */
        #pet-name {
            font-family: 'Courier New', Courier, monospace;
            font-size: 24px;
            font-weight: bold;
            background-color: #333;
            color: white;
            padding: 5px 10px;
            margin-bottom: 10px;
            display: inline-block;
            border-radius: 5px;
        }

        /* Status Bar with ASCII Icons */
        #status-bar {
            font-size: 20px;
            margin: 10px 0;
        }

        #controls button {
            font-size: 16px;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
        }

        /* Tombstone and RIP pixel art */
        #rip {
            display: none;
            margin-top: 20px;
        }

        @keyframes move-left-right {
            0% { transform: translateX(0); }
            50% { transform: translateX(-20px); }
            100% { transform: translateX(20px); }
        }

        /* Information Button */
        #info-button {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 18px;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="pet-name"></div>
        <div id="frame">
            <div id="pet-container">
                <div id="egg" class="pixel-art"></div>
                <div id="pet" class="pixel-art"></div>
                <div id="zzzz">ZZZ</div>
                <div id="poop" class="pixel-art"></div>
            </div>
        </div>
        <div id="status-bar">
            <span id="hunger">üç≤</span> / <span id="cleanliness">üßº</span> / <span id="days">‚åõ</span>
        </div>
        <div id="controls">
            <button id="feed">Feed (A)</button>
            <button id="clean">Clean (B)</button>
            <button id="sleep">Sleep (C)</button>
            <button id="awake" style="display:none;">Awake (D)</button>
            <button id="reset">START / RESET</button>
        </div>
        <button id="info-button">i</button>
        <div id="rip" class="pixel-art"></div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let pet = {
                hunger: 5,
                cleanliness: 5,
                days: 0,
                sleeping: false,
                lastFed: new Date(),
                lastCleaned: new Date(),
                name: '',
                alive: true
            };

            const petElement = document.getElementById('pet');
            const zzzzElement = document.getElementById('zzzz');
            const poopElement = document.getElementById('poop');
            const ripElement = document.getElementById('rip');
            const petNameElement = document.getElementById('pet-name');
            const eggElement = document.getElementById('egg');
            const infoButton = document.getElementById('info-button');

            function requestName() {
                const name = prompt("Please enter your pet's name:");
                pet.name = name || "Pet";
                petNameElement.innerText = pet.name;
                savePet();
            }

            function loadPet() {
                const savedPet = JSON.parse(localStorage.getItem('tamagotchi-pet'));
                if (savedPet) {
                    pet = savedPet;
                    eggElement.style.display = 'none';  // Hide egg if pet exists
                } else {
                    renderEgg();
                    requestName();
                }
                updatePetStage();
                updateDisplay();
            }

            function savePet() {
                localStorage.setItem('tamagotchi-pet', JSON.stringify(pet));
            }

            function updateDisplay() {
                document.getElementById('hunger').innerText = "üç≤ " + "I".repeat(pet.hunger);
                document.getElementById('cleanliness').innerText = "üßº " + "I".repeat(pet.cleanliness);
                document.getElementById('days').innerText = "‚åõ " + pet.days;

                if (pet.sleeping) {
                    zzzzElement.style.display = 'block';
                    document.getElementById('sleep').style.display = 'none';
                    document.getElementById('awake').style.display = 'inline-block';
                } else {
                    zzzzElement.style.display = 'none';
                    poopElement.style.display = pet.cleanliness <= 2 ? 'block' : 'none';
                }
            }

            function updatePetStage() {
                if (!pet.alive) return;
                petElement.innerHTML = '';
                if (pet.days < 4) {
                    renderBaby();
                } else if (pet.days < 8) {
                    renderKid();
                } else if (pet.days < 16) {
                    renderMid();
                } else {
                    renderAdult();
                }
                animateMovement();
            }

            function renderEgg() {
                const pixels = [
                    'transparent transparent white white white transparent transparent',
                    'transparent white black black black white transparent',
                    'white black black black black black white',
                    'white black black black black black white',
                    'white black black black black black white',
                    'transparent white black black black white transparent',
                    'transparent transparent white white white transparent transparent',
                ];
                renderPixelsToElement(pixels, eggElement);
            }

            function renderBaby() {
                const pixels = [
                    'transparent transparent black black black transparent transparent',
                    'transparent black gray gray gray black transparent',
                    'black gray gray white gray gray black',
                    'black gray gray white gray gray black',
                    'black gray gray gray gray gray black',
                    'transparent pink pink pink pink pink transparent',
                    'transparent yellow yellow transparent transparent yellow yellow',
                ];
                renderPixels(pixels);
            }

            function renderKid() {
                const pixels = [
                    'transparent transparent black black black transparent transparent',
                    'transparent black gray gray gray black transparent',
                    'black gray gray white gray gray black',
                    'black gray gray white gray gray black',
                    'black gray gray gray gray gray black',
                    'transparent pink pink pink pink pink transparent',
                    'transparent yellow yellow transparent transparent yellow yellow',
                ];
                renderPixels(pixels);
            }

            function renderMid() {
                const pixels = [
                    'transparent transparent black black black transparent transparent',
                    'transparent black gray gray gray black transparent',
                    'black gray gray white gray gray black',
                    'black gray gray white gray gray black',
                    'black gray gray gray gray gray black',
                    'transparent pink pink pink pink pink transparent',
                    'transparent yellow yellow transparent transparent yellow yellow',
                ];
                renderPixels(pixels);
            }

            function renderAdult() {
                const pixels = [
                    'transparent transparent black black black transparent transparent',
                    'transparent black gray gray gray black transparent',
                    'black gray gray white gray gray black',
                    'black gray gray white gray gray black',
                    'black gray gray gray gray gray black',
                    'transparent pink pink pink pink pink transparent',
                    'transparent yellow yellow transparent transparent yellow yellow',
                ];
                renderPixels(pixels);
            }

            function renderPixels(pixelData) {
                pixelData.forEach(row => {
                    row.split(' ').forEach(color => {
                        const pixel = document.createElement('div');
                        pixel.className = `pixel ${color}`;
                        petElement.appendChild(pixel);
                    });
                });
            }

            function renderPoop() {
                poopElement.innerHTML = '';
                const pixels = [
                    'transparent transparent black black black transparent transparent',
                    'transparent black brown brown black black transparent',
                    'black brown brown brown brown brown black',
                    'black brown brown brown brown brown black',
                    'transparent black brown brown brown black transparent',
                    'transparent transparent black black black transparent transparent',
                    'transparent pink pink transparent pink pink transparent',
                ];
                renderPixelsToElement(pixels, poopElement);
            }

            function renderRIP() {
                ripElement.innerHTML = '';
                const pixels = [
                    'transparent transparent black black black transparent transparent',
                    'transparent black black black black black transparent',
                    'black black black black black black black',
                    'black black white white white black black',
                    'black black white white white black black',
                    'black black black black black black black',
                    'transparent black black black black black transparent',
                ];
                renderPixelsToElement(pixels, ripElement);
            }

            function renderPixelsToElement(pixelData, element) {
                pixelData.forEach(row => {
                    row.split(' ').forEach(color => {
                        const pixel = document.createElement('div');
                        pixel.className = `pixel ${color}`;
                        element.appendChild(pixel);
                    });
                });
            }

            function feedPet() {
                if (!pet.sleeping && pet.alive) {
                    pet.hunger = Math.min(pet.hunger + 1, 10);
                    pet.lastFed = new Date();
                    savePet();
                    updateDisplay();

                    // Schedule poop after 7 minutes of feeding
                    setTimeout(() => {
                        if (!pet.sleeping && pet.alive) {
                            pet.cleanliness = Math.max(pet.cleanliness - 1, 0);
                            renderPoop();
                            updateDisplay();
                        }
                    }, 7 * 60 * 1000); // 7 minutes in milliseconds
                }
            }

            function cleanPet() {
                if (!pet.sleeping && pet.alive) {
                    pet.cleanliness = Math.min(pet.cleanliness + 1, 10);
                    pet.lastCleaned = new Date();
                    savePet();
                    updateDisplay();
                }
            }

            function putPetToSleep() {
                if (pet.alive) {
                    pet.sleeping = true;
                    savePet();
                    updateDisplay();
                }
            }

            function awakePet() {
                if (pet.alive) {
                    pet.sleeping = false;
                    savePet();
                    updateDisplay();
                }
            }

            function resetPet() {
                if (confirm("Are you sure you want to reset the pet?")) {
                    pet = {
                        hunger: 5,
                        cleanliness: 5,
                        days: 0,
                        sleeping: false,
                        lastFed: new Date(),
                        lastCleaned: new Date(),
                        name: '',
                        alive: true
                    };
                    eggElement.style.display = 'none';
                    requestName();
                    updatePetStage();
                    updateDisplay();
                    savePet();
                }
            }

            function checkPetHealth() {
                const now = new Date();
                const hoursSinceLastFed = (now - new Date(pet.lastFed)) / (1000 * 60 * 60);
                const hoursSinceLastCleaned = (now - new Date(pet.lastCleaned)) / (1000 * 60 * 60);

                if (pet.hunger === 0 && hoursSinceLastFed >= 8) {
                    pet.alive = false;
                }
                if (pet.cleanliness === 0 && hoursSinceLastCleaned >= 4) {
                    pet.alive = false;
                }

                if (!pet.alive) {
                    renderRIP();
                    petElement.style.display = 'none';
                    zzzzElement.style.display = 'none';
                    poopElement.style.display = 'none';
                    ripElement.style.display = 'block';
                    alert(`${pet.name} has died. Press Start / Reset to start over.`);
                }
            }

            function animateMovement() {
                const petContainer = document.getElementById('pet-container');
                const frameWidth = document.getElementById('frame').clientWidth;
                const frameHeight = document.getElementById('frame').clientHeight;

                // Random movement inside the frame
                setInterval(() => {
                    const randomX = Math.floor(Math.random() * (frameWidth - 75));
                    const randomY = Math.floor(Math.random() * (frameHeight - 75));

                    petContainer.style.left = `${randomX}px`;
                    petContainer.style.top = `${randomY}px`;
                }, 2000); // Change position every 2 seconds
            }

            // Day progression: 1 day every 24 hours
            setInterval(() => {
                if (!pet.sleeping && pet.alive) {
                    pet.days += 1;
                    updatePetStage();
                    savePet();
                    updateDisplay();
                }
            }, 24 * 60 * 60 * 1000); // 24 hours in milliseconds

            // Health check interval
            setInterval(() => {
                if (pet.alive) {
                    checkPetHealth();
                    savePet();
                }
            }, 60 * 1000); // Check every minute

            // Event Listeners
            document.getElementById('feed').addEventListener('click', feedPet);
            document.getElementById('clean').addEventListener('click', cleanPet);
            document.getElementById('sleep').addEventListener('click', putPetToSleep);
            document.getElementById('awake').addEventListener('click', awakePet);
            document.getElementById('reset').addEventListener('click', resetPet);
            infoButton.addEventListener('click', function() {
                alert('PETCHI 1.1 created by Luis Villanueva DIGITAL GOD, contact: contacto.luisvillanueva@gmail.com');
            });

            // Initial Load
            loadPet();

            // Simulate time passing for hunger and cleanliness
            setInterval(function () {
                if (!pet.sleeping && pet.alive) {
                    pet.hunger = Math.max(pet.hunger - 1, 0);
                    pet.cleanliness = Math.max(pet.cleanliness - 1, 0);
                    if (pet.hunger === 0 || pet.cleanliness === 0) {
                        checkPetHealth();
                    }
                    savePet();
                    updateDisplay();
                }
            }, 60 * 1000); // Every 60 seconds
        });
    </script>
</body>
</html>

